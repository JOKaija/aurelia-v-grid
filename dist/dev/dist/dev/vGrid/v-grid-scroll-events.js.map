{"version":3,"sources":["vGrid/v-grid-scroll-events.js"],"names":[],"mappings":"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","file":"vGrid/v-grid-scroll-events.js","sourceRoot":"/source/","sourcesContent":["/*****************************************************************************************************************\n *    VGridScrollEvents\n *    This just have all the scroll functions the vGridGenerator needs\n *    Created by vegar ringdal\n *\n ****************************************************************************************************************/\nexport class VGridScrollEvents {\n\n  constructor(vGrid) {\n    this.vGrid = vGrid;\n    this.lastScrollTop = 0;\n    this.lastScrollLeft = 0;\n    this.isScrollBarScrolling = false;\n    this.scrollbarScrollingTimer = null;\n    this.lastScrollType = null\n  }\n\n  get vGridGenerator() {\n    if (this.vGrid) {\n      return this.vGrid.vGridGenerator;\n    } else {\n      return null;\n    }\n  }\n\n  get vGridSelection() {\n    if (this.vGrid) {\n      return this.vGrid.vGridSelection;\n    } else {\n      return null;\n    }\n  }\n\n  get vGridConfig() {\n    if (this.vGrid) {\n      return this.vGrid.vGridConfig;\n    } else {\n      return null;\n    }\n  }\n\n  get vGridCellHelper() {\n    if (this.vGrid) {\n      return this.vGrid.vGridCellHelper;\n    } else {\n      return null;\n    }\n  }\n\n  get vGridElement() {\n    if (this.vGrid) {\n      return this.vGrid.element;\n    } else {\n      return null;\n    }\n  }\n\n  get vGridSortable() {\n    if (this.vGrid) {\n      return this.vGrid.vGridSortable;\n    } else {\n      return null;\n    }\n  }\n\n  get vGridResizable() {\n    if (this.vGrid) {\n      return this.vGrid.vGridResizable;\n    } else {\n      return null;\n    }\n  }\n\n  /****************************************************************************************************************************\n   * option to scrollbars scrolling where we update all the time and dont use timeout\n   ****************************************************************************************************************************/\n  onLargeScroll() {\n\n    this.lastScrollTop = this.vGridGenerator.contentElement.scrollTop;\n\n    if (this.vGridConfig.getCollectionLength() <= this.vGridGenerator.rowElementArray.length) {\n      this.lastScrollTop = 0;\n    }\n\n\n    //vars\n    var rowHeight = this.vGridConfig.attRowHeight;\n    var bodyHeight = this.vGridGenerator.contentElement.clientHeight;\n    var currentRow = parseInt(this.lastScrollTop / rowHeight, 10);\n    var firstRow = parseInt(this.vGridGenerator.contentElement.scrollTop / rowHeight, 10);\n    var currentRowTop = rowHeight * currentRow;\n    var firstRowTop = rowHeight * firstRow;\n    var collectionLength = this.vGridConfig.getCollectionLength();\n\n\n    //for setting after\n    var setAfter = (cacheRowNumber) => {\n      var row = this.vGridGenerator.rowElementArray[cacheRowNumber];\n      this.vGridGenerator.setRowTopValue([row], 0, currentRowTop);\n      currentRowTop = currentRowTop + rowHeight;\n    };\n\n\n    //for setting before (when hitting bottom)\n    var setBefore = (cacheRowNumber) => {\n      var row = this.vGridGenerator.rowElementArray[cacheRowNumber];\n      firstRowTop = firstRowTop - rowHeight;\n      this.vGridGenerator.setRowTopValue([row], 0, firstRowTop);\n    };\n\n\n    //for setting before (when hitting bottom)\n    var setHiddenFromView = (cacheRowNumber) => {\n      var row = this.vGridGenerator.rowElementArray[cacheRowNumber];\n      this.vGridGenerator.setRowTopValue([row], 0, -(currentRowTop + (this.vGridConfig.attRowHeight * 50)));\n    };\n\n    //loop row html cache\n    for (var i = 0; i < this.vGridGenerator.getRowCacheLength(); i++) {\n      var moved = false;\n      switch (true) {\n        case currentRow >= 0 && currentRow <= collectionLength - 1:\n          setAfter(i);\n          moved = true;\n          break;\n        case currentRow >= collectionLength && (collectionLength * rowHeight) >= bodyHeight:\n          setBefore(i);\n          moved = true;\n          break;\n      }\n      if (!moved) {\n        if (currentRow >= collectionLength && (currentRowTop - rowHeight) >= bodyHeight) {\n          setHiddenFromView(i);\n        } else {\n          //if this triggers the collection have been removed, so really just need to place out the rows\n          if (currentRow >= collectionLength) {\n            setAfter(i);\n          }\n        }\n      }\n\n      currentRow++;\n    }\n\n\n    //I now sort the array again.\n    this.vGridGenerator.rowElementArray.sort(\n      function (a, b) {\n        return parseInt(a.top) - parseInt(b.top)\n      });\n\n    //update row data\n    this.vGridGenerator.rebindAllRowSlots();\n  };\n\n\n  /****************************************************************************************************************************\n   * add the rows to scroll div (for normal scrolling when not using scrollbars)\n   ****************************************************************************************************************************/\n  onSmallScroll(isDownScroll, currentScrollTop) {\n\n    //check is user have preformed big scroll\n    var currentScrollTop = this.vGridGenerator.contentElement.scrollTop;\n    if (this.isScrollBarScrolling === false) {\n\n\n      var newTopValue;\n      var currentRow = parseInt((this.lastScrollTop / this.vGridConfig.attRowHeight), 10);\n      var collectionHeight = this.vGridConfig.attRowHeight * this.vGridGenerator.getRowCacheLength();\n      var rowHeight = this.vGridConfig.attRowHeight;\n\n      //loop our row html cache\n      for (var i = 0; i < this.vGridGenerator.getRowCacheLength(); i++) {\n\n        var row = this.vGridGenerator.rowElementArray[i];\n        var rowTop = parseInt(row.top, 10);\n        var update = false;\n\n\n        if (isDownScroll) {\n          this.lastScrollType = \"down\";\n          if (rowTop < (currentScrollTop - rowHeight)) {\n            update = true;\n            newTopValue = rowTop + collectionHeight;\n            currentRow = (rowTop + collectionHeight) / rowHeight;\n          }\n\n          //if for some reason the new rowtop is higher then collection, and content height (for cases where very small collection)\n          if (rowTop > ((this.vGridConfig.getCollectionLength() - 1) * rowHeight) && rowTop > this.vGridGenerator.contentHeight) {\n            update = false;\n            this.vGridGenerator.setRowTopValue([row], 0, -((rowHeight * i) + (rowHeight * 50)));\n          }\n\n        } else {\n          this.lastScrollType = \"up\";\n          if (rowTop > (currentScrollTop + this.vGridGenerator.contentHeight)) {\n            update = true;\n            newTopValue = rowTop - collectionHeight;\n            currentRow = (rowTop - collectionHeight) / rowHeight;\n          }\n\n        }\n\n        //update data\n        if (update === true && currentRow >= 0 && currentRow <= this.vGridConfig.getCollectionLength() - 1) {\n          this.vGridGenerator.setRowTopValue([row], 0, newTopValue);\n          this.vGridConfig.updateRowBinding(currentRow, row, isDownScroll, false);\n        }\n\n      }\n\n      //sort the cache array so we loop in correct order\n      this.vGridGenerator.rowElementArray.sort(\n        function (a, b) {\n          return parseInt(a.top) - parseInt(b.top)\n        });\n\n    } else {\n\n      //just in case user scrolls big then small, do not want to update before he stops\n      this.onScrollbarScrolling()\n    }\n\n  };\n\n\n  /****************************************************************************************************************************\n   * option to scrollbars scrolling where we dont update all the time and use timeout (\n   * plan was to use this with virtual scrolling with datasource using chaching to fetch data, you dont want to try and get 500 k rows in 5 sec\n   ****************************************************************************************************************************/\n  onScrollbarScrolling() {\n    //set halt var to true, so small scroll will be stopped, will be laggy else\n    this.isScrollBarScrolling = true;\n\n    //delay before doing update\n    var timeout = this.vGridConfig.attDataScrollDelay;\n\n    //clear scroll timeout\n    clearTimeout(this.scrollbarScrollingTimer);\n\n    //set timeout, incase user is still scrolling\n    this.scrollbarScrollingTimer = setTimeout(() => {\n      this.onLargeScroll();\n      this.isScrollBarScrolling = false;\n    }, timeout);\n\n\n  };\n\n\n  /****************************************************************************************************************************\n   * fixes scrolling / top of divs\n   ****************************************************************************************************************************/\n  scrollEventHandler() {\n\n\n    var currentScrollTop = this.vGridGenerator.contentElement.scrollTop;\n    var currentScrollLeft = this.vGridGenerator.contentElement.scrollLeft;\n\n\n    //are we scrolling ?\n    if (currentScrollTop !== this.lastScrollTop) {\n      //is vert scroll\n\n      //stop left scroll...\n      if (currentScrollLeft !== 0) {\n        this.vGridGenerator.contentElement.scrollLeft = this.lastScrollLeft;\n        this.vGridGenerator.headerElement.scrollLeft = this.lastScrollLeft\n      }\n\n      //check if down scroll.\n      var isDownScroll = true;\n      if (currentScrollTop < this.lastScrollTop) {\n        isDownScroll = false;\n      }\n\n      //check if big scroll (split m into 2.. simple to read)\n      var isLargeScroll;\n      switch (true) {\n        case currentScrollTop > this.lastScrollTop + this.vGridConfig.largeScrollLimit:\n        case currentScrollTop < this.lastScrollTop - this.vGridConfig.largeScrollLimit:\n          isLargeScroll = true;\n          break;\n        default:\n          isLargeScroll = false;\n      }\n\n      //reset scroll top\n      this.lastScrollTop = currentScrollTop;\n\n      //check if big scroll\n      if (isLargeScroll) {\n        //now user can set this, on very large collections this will drag preformance down\n        if (this.vGridConfig.attRenderOnScrollbarScroll) {\n          this.onLargeScroll()\n        } else {\n          this.onScrollbarScrolling();\n        }\n      } else {\n        this.onSmallScroll(isDownScroll, currentScrollTop)\n      }\n    } else {\n\n      if (this.vGridGenerator.contentElement.style.overflowX === \"hidden\") {\n        //we do not want scrolls left if this is hidden..\n        this.vGridGenerator.contentElement.scrollLeft = 0;\n        this.lastScrollLeft = 0;\n        this.vGridGenerator.headerElement.scrollLeft = 0;\n      } else {\n        if (this.lastScrollLeft !== currentScrollLeft) {\n          currentScrollLeft = this.vGridGenerator.contentElement.scrollLeft;\n          this.lastScrollLeft = currentScrollLeft;\n          this.vGridGenerator.headerElement.scrollLeft = currentScrollLeft;\n        }\n      }\n    }\n  }\n\n}\n"]}