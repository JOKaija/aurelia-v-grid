{"version":3,"sources":["vGrid/v-grid-attributes-key-move.js"],"names":["inject","customAttribute","VGrid","vGridAttributesKeyMove","Element","element","vGrid","classname","bind","bindingContext","overrideContext","attached","classList","add","addGridKeyListner","addEventListener","e","focus","ev","document","createEvent","initEvent","offsetParent","dispatchEvent","vGridCurrentEntityRef","dispatchCellClick","index","cells","setCellsFromElement","node","direction","thisTop","i","contains","vGridConfig","css","row","parseInt","getAttribute","y","vGridGenerator","rowElementArray","length","top","attRowHeight","div","parentNode","err","querySelectorAll","setCellsFromTopValue","keyDownDelay","callback","timer","setTimeout","getIndex","first","last","onkeydown","keyCode","preventDefault","rowHeight","containerHeight","contentElement","clientHeight","containerRows","newTop","vGridScrollEvents","lastScrollType","onSmallScroll","setTop","vGridClientCtx","setScrollTop","currentscrolltop","getScrollTop","getCollectionLength","shiftKey"],"mappings":"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","file":"vGrid/v-grid-attributes-key-move.js","sourceRoot":"/source/","sourcesContent":["/*****************************************************************************************************************\r\n *    Attributes for tabbing, keyup/down and page up/down\r\n *    Created by vegar ringdal\r\n *\r\n ****************************************************************************************************************/\r\nimport {inject, customAttribute} from 'aurelia-framework';\r\nimport {VGrid} from './v-grid';\r\n\r\n\r\n@customAttribute('v-key-move')\r\n@inject(Element, VGrid)\r\nexport class vGridAttributesKeyMove {\r\n\r\n\r\n  constructor(element, vGrid) {\r\n    this.vGrid = vGrid;\r\n    this.element = element;\r\n    this.classname = \"v-grid-key-move\";\r\n  }\r\n\r\n\r\n  bind(bindingContext, overrideContext) {\r\n    this.bindingContext = bindingContext;\r\n    this.overrideContext = overrideContext;\r\n\r\n  }\r\n\r\n\r\n  attached() {\r\n    this.element.classList.add(this.classname);\r\n    this.addGridKeyListner();\r\n\r\n    this.element.addEventListener('tabbing', (e)=> {\r\n      this.element.focus();\r\n\r\n      let ev = document.createEvent('Event');\r\n      ev.initEvent(\"click\", true, true);\r\n      this.element.offsetParent.dispatchEvent(ev);\r\n\r\n    });\r\n\r\n\r\n    this.element.addEventListener('focus', ()=> {\r\n\r\n      if (this.vGrid.vGridCurrentEntityRef === null) {\r\n        let ev = document.createEvent('Event');\r\n        ev.initEvent(\"click\", true, true);\r\n        this.element.offsetParent.dispatchEvent(ev);\r\n      }\r\n\r\n\r\n\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n  /***************************************************************************************\r\n   * for setting next cell ny similating a mouse click, used for tabbing etc\r\n   ***************************************************************************************/\r\n  dispatchCellClick(index) {\r\n    var e = document.createEvent('Event');\r\n    e.initEvent(\"tabbing\", true, true);\r\n\r\n    if (this.cells[index]) {\r\n      this.cells[index].dispatchEvent(e);\r\n    }\r\n  }\r\n\r\n\r\n  /***************************************************************************************\r\n   * sets \"the cells\" from  to direction asked for, so tabbing jumps to next row\r\n   ***************************************************************************************/\r\n  setCellsFromElement(node, direction) {\r\n    var thisTop;\r\n    var element;\r\n    for (var i = 0; i < 10; i++) {\r\n      try {\r\n        if (node.classList.contains(this.vGrid.vGridConfig.css.row)) {\r\n          var row = parseInt(node.getAttribute(\"row\"));\r\n          for (var y = 0; y < this.vGrid.vGridGenerator.rowElementArray.length; y++) {\r\n            if (row === parseInt((this.vGrid.vGridGenerator.rowElementArray[y].top / this.vGrid.vGridConfig.attRowHeight))) {\r\n              this.row = row;\r\n              thisTop = this.vGrid.vGridGenerator.rowElementArray[y + direction].top;\r\n              element = this.vGrid.vGridGenerator.rowElementArray[y + direction].div;\r\n            }\r\n          }\r\n        }\r\n        node = node.parentNode;\r\n      } catch (err) {\r\n        //nothing for now\r\n      }\r\n    }\r\n    if (element) {\r\n      this.cells = element.querySelectorAll(\".\" + this.classname);\r\n    }\r\n    return thisTop;\r\n  }\r\n\r\n\r\n  /***************************************************************************************\r\n   * sets \"the cells\" from a top value, used for page up/down\r\n   ***************************************************************************************/\r\n  setCellsFromTopValue(top) {\r\n    var element = 0;\r\n    for (var i = 0; i < this.vGrid.vGridGenerator.rowElementArray.length; i++) {\r\n      if (this.vGrid.vGridGenerator.rowElementArray[i].top === top) {\r\n        element = this.vGrid.vGridGenerator.rowElementArray[i].div;\r\n      }\r\n    }\r\n    if (element) {\r\n      this.cells = element.querySelectorAll(\".\" + this.classname);\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /***************************************************************************************\r\n   * simple delay for the keydown events, like tabbing etc, so I cantrol the speed of it\r\n   ***************************************************************************************/\r\n  keyDownDelay(callback) {\r\n    if (!this.timer) {\r\n      this.timer = setTimeout(()=> {\r\n        this.timer = null;\r\n        callback();\r\n      }, 150);\r\n    }\r\n  }\r\n\r\n\r\n  /***************************************************************************************\r\n   * get the index\r\n   ***************************************************************************************/\r\n  getIndex() {\r\n    for (var i = 0; i < this.cells.length; i++) {\r\n      if (this.element === this.cells[i]) {\r\n        this.index = i;\r\n        if (i === 0) {\r\n          this.first = true;\r\n        } else {\r\n          this.first = false;\r\n        }\r\n        if (i === this.cells.length - 1) {\r\n          this.last = true;\r\n        } else {\r\n          this.last = false;\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /***************************************************************************************\r\n   * adds main keys, like arrow keys, tab, and page up/down\r\n   ***************************************************************************************/\r\n  addGridKeyListner() {\r\n\r\n\r\n    this.element.onkeydown = (e) => {\r\n\r\n\r\n      this.setCellsFromElement(this.element, 0);\r\n      this.getIndex();\r\n\r\n\r\n      //page up\r\n      if (e.keyCode === 33) {\r\n        e.preventDefault();\r\n        this.keyDownDelay(() => {\r\n\r\n\r\n         //get content height/rows\r\n          var rowHeight = this.vGrid.vGridConfig.attRowHeight;\r\n          var containerHeight = this.vGrid.vGridGenerator.contentElement.clientHeight;\r\n          var containerRows = parseInt(containerHeight / rowHeight, 10);\r\n          this.top = this.setCellsFromElement(this.element, 0);\r\n\r\n          var newTop = this.top - (containerRows * rowHeight);\r\n          if ((newTop / rowHeight) <= 0) {\r\n            newTop = 0;\r\n          }\r\n\r\n\r\n          //if last scroll was up then we need to reverse the buffer\r\n          if (this.vGrid.vGridScrollEvents.lastScrollType === \"down\") {\r\n            this.vGrid.vGridScrollEvents.onSmallScroll(false);\r\n          }\r\n\r\n          this.setCellsFromTopValue(newTop);\r\n          this.dispatchCellClick(this.index);\r\n\r\n          var setTop = newTop - parseInt((containerRows * rowHeight) / 2);\r\n          this.vGrid.vGridClientCtx.setScrollTop(setTop);\r\n\r\n\r\n        });\r\n      }\r\n\r\n\r\n      //page down\r\n      if (e.keyCode === 34) {\r\n        e.preventDefault();\r\n        this.keyDownDelay(() => {\r\n\r\n\r\n          //get scrolltop\r\n          var currentscrolltop = this.vGrid.vGridClientCtx.getScrollTop();\r\n\r\n          //get content height/rows\r\n          var rowHeight = this.vGrid.vGridConfig.attRowHeight;\r\n          var containerHeight = this.vGrid.vGridGenerator.contentElement.clientHeight;\r\n          var containerRows = parseInt(containerHeight / rowHeight, 10);\r\n          this.top = this.setCellsFromElement(this.element, 0);\r\n\r\n          var newTop = this.top + (containerRows * rowHeight);\r\n          if ((newTop / rowHeight) >= this.vGrid.vGridConfig.getCollectionLength()) {\r\n            newTop = this.vGrid.vGridConfig.getCollectionLength() * rowHeight;\r\n            newTop = newTop - rowHeight\r\n          }\r\n\r\n          //if last scroll was up then we need to reverse the buffer\r\n          if (this.vGrid.vGridScrollEvents.lastScrollType === \"up\") {\r\n            this.vGrid.vGridScrollEvents.onSmallScroll(true);\r\n          }\r\n\r\n          this.setCellsFromTopValue(newTop);\r\n          this.dispatchCellClick(this.index);\r\n\r\n          var setTop = newTop - parseInt((containerRows * rowHeight) / 2);\r\n          this.vGrid.vGridClientCtx.setScrollTop(setTop);\r\n        });\r\n      }\r\n\r\n      //arrow down\r\n      if (e.keyCode === 40) {\r\n        e.preventDefault();\r\n        this.keyDownDelay(() => {\r\n          if (this.vGrid.vGridScrollEvents.lastScrollType === \"up\") {\r\n            this.vGrid.vGridScrollEvents.onSmallScroll(true);\r\n          }\r\n          this.top = this.setCellsFromElement(this.element, +1);\r\n          this.dispatchCellClick(this.index)\r\n        });\r\n      }\r\n\r\n\r\n      //arrow up\r\n      if (e.keyCode === 38) {\r\n        e.preventDefault();\r\n        this.keyDownDelay(() => {\r\n          if (this.vGrid.vGridScrollEvents.lastScrollType === \"down\") {\r\n            this.vGrid.vGridScrollEvents.onSmallScroll(false);\r\n          }\r\n          this.top = this.setCellsFromElement(this.element, -1);\r\n          this.dispatchCellClick(this.index)\r\n        });\r\n      }\r\n\r\n\r\n      //tab and shift key for tabing in other direction\r\n      if (e.keyCode === 9 && e.shiftKey === true) {\r\n        if (this.row !== 0 && this.first) {\r\n          e.preventDefault();\r\n          this.keyDownDelay(() => {\r\n            this.index = this.index - 1;\r\n            if (this.first) {\r\n              if (this.vGrid.vGridScrollEvents.lastScrollType === \"down\") {\r\n                this.vGrid.vGridScrollEvents.onSmallScroll(false);\r\n              }\r\n              this.index = this.cells.length - 1;\r\n              this.top = this.setCellsFromElement(this.element, -1)\r\n            }\r\n            this.dispatchCellClick(this.index)\r\n\r\n          });\r\n        }\r\n      }\r\n\r\n\r\n      //normal tabbing\r\n      if (e.keyCode === 9 && e.shiftKey === false) {\r\n\r\n\r\n        e.preventDefault();\r\n        this.keyDownDelay(() => {\r\n          this.index = this.index + 1;\r\n          if (this.last) {\r\n            if (this.vGrid.vGridScrollEvents.lastScrollType === \"up\") {\r\n              this.vGrid.vGridScrollEvents.onSmallScroll(true);\r\n            }\r\n            this.index = 0;\r\n            this.top = this.setCellsFromElement(this.element, 1)\r\n          }\r\n          this.dispatchCellClick(this.index)\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n\r\n}\r\n"]}